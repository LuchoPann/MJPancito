<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mis Minijuegos</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap");

      #mainContent.blurred {
        filter: blur(8px);
        pointer-events: none;
      }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body
    class="bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen p-4 transition-colors duration-200"
  >
    <!-- Modal de Login/Registro -->
    <div
      id="loginModal"
      class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
    >
      <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full">
        <div class="text-center mb-6">
          <div class="text-5xl mb-3">üéÆ</div>
          <h2 class="text-2xl font-bold text-gray-800 mb-2">
            Centro de Juegos
          </h2>
          <p class="text-gray-600">Inicia sesi√≥n para guardar tu progreso</p>
        </div>

        <!-- Tabs -->
        <div class="flex gap-2 mb-6 border-b border-gray-200">
          <button
            id="tabLogin"
            onclick="cambiarTab('login')"
            class="flex-1 py-2 px-4 text-center font-semibold border-b-2 border-blue-500 text-blue-600"
          >
            Iniciar Sesi√≥n
          </button>
          <button
            id="tabRegistro"
            onclick="cambiarTab('registro')"
            class="flex-1 py-2 px-4 text-center font-semibold border-b-2 border-transparent text-gray-600 hover:text-gray-800"
          >
            Registrarse
          </button>
        </div>

        <!-- Login Form -->
        <div id="loginForm" class="space-y-4">
          <input
            type="email"
            id="loginEmail"
            placeholder="tu@email.com"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            type="password"
            id="loginPassword"
            placeholder="Contrase√±a"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <button
            id="btnLogin"
            class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
          >
            Iniciar Sesi√≥n
          </button>
        </div>

        <!-- Registro Form -->
        <div id="registroForm" class="space-y-4 hidden">
          <input
            type="text"
            id="registroNombre"
            placeholder="Tu nombre completo"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            type="email"
            id="registroEmail"
            placeholder="tu@email.com"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            type="password"
            id="registroPassword"
            placeholder="Contrase√±a (m√≠n. 6 caracteres)"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            type="password"
            id="registroPasswordConfirm"
            placeholder="Confirmar contrase√±a"
            class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <button
            id="btnRegistro"
            class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
          >
            Crear Cuenta
          </button>
        </div>

        <p class="text-center text-gray-600 text-sm mt-4">
          Tu informaci√≥n se guardar√° de forma segura en la nube
        </p>
      </div>
    </div>

    <div
      id="mainContent"
      class="max-w-6xl mx-auto transition-all duration-300 blurred"
    >
      <!-- Header -->
      <header class="mb-12 text-center">
        <div class="flex items-center justify-between mb-4">
          <div></div>
          <div class="flex gap-3">
            <!-- Bot√≥n Estad√≠sticas -->
            <button
              onclick="abrirEstadisticas()"
              class="bg-white hover:bg-pink-50 hover:shadow-lg p-3 rounded-lg transition-all duration-200 text-2xl shadow-md"
              title="Estad√≠sticas"
            >
              üìä
            </button>
            <!-- Bot√≥n Configuraci√≥n -->
            <button
              onclick="abrirConfiguracion()"
              class="bg-white hover:bg-purple-50 hover:shadow-lg p-3 rounded-lg transition-all duration-200 text-2xl shadow-md"
              title="Configuraci√≥n"
            >
              ‚öôÔ∏è
            </button>
          </div>
        </div>
        <h1 class="text-5xl md:text-6xl font-bold text-purple-600 mb-2">
          üéÆ Centro de Juegos
        </h1>
        <p class="text-gray-600 text-lg">
          Aprende y divi√©rtete con nuestros minijuegos educativos
        </p>
      </header>

      <!-- Secci√≥n Minijuegos -->
      <section class="mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
          <span class="text-2xl mr-3">üéØ</span> Minijuegos
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Sopa de Letras -->
          <a
            href="games/Sopita.html"
            class="bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 transition-all duration-300 hover:-translate-y-1 border-l-4 border-blue-300 hover:border-l-blue-500 hover:bg-blue-50"
          >
            <div class="text-4xl mb-3">üî§</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Sopa de Letras</h3>
            <p class="text-gray-600 text-sm mb-4">
              Encuentra todas las palabras escondidas en la cuadr√≠cula
            </p>
            <div
              class="text-blue-500 font-semibold text-sm flex items-center gap-1 group"
            >
              Jugar
              <span class="transition-transform group-hover:translate-x-1"
                >‚Üí</span
              >
            </div>
          </a>

          <!-- Crucigrama -->
          <a
            href="games/Crucigrama.html"
            class="bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 transition-all duration-300 hover:-translate-y-1 border-l-4 border-purple-300 hover:border-l-purple-500 hover:bg-purple-50"
          >
            <div class="text-4xl mb-3">üß©</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Crucigrama</h3>
            <p class="text-gray-600 text-sm mb-4">
              Completa el crucigrama resolviendo pistas y palabras cruzadas
            </p>
            <div
              class="text-purple-500 font-semibold text-sm flex items-center gap-1 group"
            >
              Jugar
              <span class="transition-transform group-hover:translate-x-1"
                >‚Üí</span
              >
            </div>
          </a>

          <!-- Ruleta -->
          <a
            href="games/Ruleta.html"
            class="bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 transition-all duration-300 hover:-translate-y-1 border-l-4 border-pink-300 hover:border-l-pink-500 hover:bg-pink-50"
          >
            <div class="text-4xl mb-3">üé°</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Ruleta</h3>
            <p class="text-gray-600 text-sm mb-4">
              Gira la ruleta y ‚ô´ prueba tu suerte conmigo, pruebate a la suerte
              ‚ô´
            </p>
            <div
              class="text-pink-500 font-semibold text-sm flex items-center gap-1 group"
            >
              Jugar
              <span class="transition-transform group-hover:translate-x-1"
                >‚Üí</span
              >
            </div>
          </a>
        </div>
      </section>

      <!-- Secci√≥n Herramientas -->
      <section class="mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
          <span class="text-2xl mr-3">üõ†Ô∏è</span> Herramientas
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Generador de Cuestionarios -->
          <button
            onclick="proximamente(event)"
            class="bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 transition-all duration-300 hover:-translate-y-1 border-l-4 border-green-300 text-left hover:bg-green-50"
          >
            <div class="text-4xl mb-3">üìù</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">
              Generador de Cuestionarios
            </h3>
            <p class="text-gray-600 text-sm mb-4">
              Crea cuestionarios personalizados para evaluar conocimientos
            </p>
            <div class="text-green-500 font-semibold text-sm">
              Pr√≥ximamente ‚Üí
            </div>
          </button>

          <!-- Flashcards -->
          <button
            onclick="proximamente(event)"
            class="bg-white rounded-xl shadow-lg hover:shadow-2xl p-6 transition-all duration-300 hover:-translate-y-1 border-l-4 border-yellow-300 text-left hover:bg-yellow-50"
          >
            <div class="text-4xl mb-3">üóÇÔ∏è</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Flashcards</h3>
            <p class="text-gray-600 text-sm mb-4">
              Estudia con tarjetas interactivas y mejora tu memoria
            </p>
            <div class="text-yellow-500 font-semibold text-sm">
              Pr√≥ximamente ‚Üí
            </div>
          </button>
        </div>
      </section>
    </div>

    <!-- Modal Pr√≥ximamente -->
    <div
      id="proximamenteModal"
      class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full transform transition-all"
      >
        <div class="text-center">
          <div class="text-6xl mb-4">‚è∞</div>
          <h2 class="text-2xl font-bold text-gray-800 mb-2">Pr√≥ximamente</h2>
          <p class="text-gray-600 mb-6">
            Esta funci√≥n est√° en desarrollo. ¬°Vuelve pronto para verla en
            acci√≥n!
          </p>
          <button
            onclick="cerrarProximamente()"
            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg transition-colors"
          >
            Entendido
          </button>
        </div>
      </div>
    </div>

    <!-- Slide Panel -->
    <div
      id="slidePanel"
      class="fixed inset-y-0 right-0 w-full max-w-md bg-gradient-to-br from-white to-pink-50 shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out z-40 overflow-y-auto"
    >
      <div class="p-6 md:p-8">
        <!-- Header del Panel -->
        <div class="flex items-center justify-between mb-6">
          <button
            id="btnVolver"
            onclick="volverMenu()"
            class="text-gray-500 hover:text-gray-700 text-2xl transition-colors hidden"
          >
            ‚Üê
          </button>
          <div class="flex-1"></div>
          <button
            onclick="cerrarSlide()"
            class="text-gray-500 hover:text-gray-700 text-2xl transition-colors"
          >
            ‚úï
          </button>
        </div>

        <!-- Contenido del Panel -->
        <div id="panelContent" class="space-y-6">
          <!-- Default: Perfil -->
          <div id="perfilContent" class="space-y-6">
            <!-- Avatar y Foto de Perfil -->
            <div class="text-center">
              <div class="relative inline-block mb-4">
                <img
                  id="fotoPerfil"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23e5e7eb'/%3E%3Ctext x='50' y='60' font-size='50' text-anchor='middle' fill='%239ca3af'%3Eüë§%3C/text%3E%3C/svg%3E"
                  class="w-24 h-24 rounded-full border-4 border-blue-300 object-cover"
                />
                <label
                  class="absolute bottom-0 right-0 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full cursor-pointer transition-colors shadow-lg"
                >
                  <input
                    type="file"
                    id="inputFoto"
                    accept="image/*"
                    class="hidden"
                  />
                  üì∑
                </label>
              </div>
              <h3 id="nombrePerfil" class="text-xl font-bold text-gray-800">
                Usuario
              </h3>
              <p id="emailPerfil" class="text-gray-600 text-sm">
                usuario@ejemplo.com
              </p>
            </div>

            <!-- Informaci√≥n B√°sica (Solo lectura) -->
            <div class="border-t border-gray-200 pt-6">
              <h4 class="text-lg font-semibold text-gray-800 mb-4">
                Informaci√≥n B√°sica
              </h4>
              <div class="space-y-4 bg-gray-50 p-4 rounded-lg">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">
                    Nombre Completo
                  </label>
                  <p id="displayNombre" class="text-gray-800 font-medium">-</p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">
                    Correo Electr√≥nico
                  </label>
                  <p id="displayEmail" class="text-gray-800 font-medium">-</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                      Edad
                    </label>
                    <p id="displayEdad" class="text-gray-800 font-medium">-</p>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                      Sexo
                    </label>
                    <p id="displaySexo" class="text-gray-800 font-medium">-</p>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">
                    Fecha de Nacimiento
                  </label>
                  <p
                    id="displayFechaNacimiento"
                    class="text-gray-800 font-medium"
                  >
                    -
                  </p>
                </div>
              </div>
            </div>

            <!-- Editar Informaci√≥n -->
            <div class="border-t border-gray-200 pt-6">
              <button
                onclick="mostrarSubContenido('editar-perfil')"
                class="w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:shadow-md transition-all"
              >
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-800">‚úèÔ∏è Editar Perfil</h4>
                  <span class="text-blue-500">‚Üí</span>
                </div>
                <p class="text-gray-600 text-sm">
                  Actualiza tu informaci√≥n personal
                </p>
              </button>
            </div>

            <!-- Bot√≥n Cerrar Sesi√≥n -->
            <div class="pt-4 space-y-2">
              <button
                id="btnCerrarSesion"
                class="w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
              >
                üö™ Cerrar Sesi√≥n
              </button>
            </div>
          </div>

          <!-- Ayuda y Soporte -->
          <div id="ayudaContent" class="space-y-6 hidden">
            <div class="text-center">
              <div class="text-6xl mb-4">‚ÑπÔ∏è</div>
              <h3 class="text-xl font-bold text-gray-800">Ayuda y Soporte</h3>
              <p class="text-gray-600 text-sm">
                Encuentra respuestas a tus preguntas
              </p>
            </div>

            <!-- Preguntas Frecuentes -->
            <div class="space-y-4">
              <h4 class="text-lg font-semibold text-gray-800">
                Preguntas Frecuentes
              </h4>

              <details
                class="border border-gray-300 rounded-lg p-4 cursor-pointer"
              >
                <summary
                  class="font-semibold text-gray-800 hover:text-blue-500"
                >
                  ¬øC√≥mo empiezo a jugar?
                </summary>
                <p class="mt-2 text-gray-600 text-sm">
                  Dir√≠gete a la secci√≥n "Minijuegos" en la p√°gina principal y
                  selecciona el juego que desees. Los juegos se abrir√°n en una
                  nueva ventana.
                </p>
              </details>

              <details
                class="border border-gray-300 rounded-lg p-4 cursor-pointer"
              >
                <summary
                  class="font-semibold text-gray-800 hover:text-blue-500"
                >
                  ¬øC√≥mo se guardan mis datos?
                </summary>
                <p class="mt-2 text-gray-600 text-sm">
                  Tus datos se guardan autom√°ticamente en tu navegador. Cada
                  juego mantiene un registro de tu progreso.
                </p>
              </details>

              <details
                class="border border-gray-300 rounded-lg p-4 cursor-pointer"
              >
                <summary
                  class="font-semibold text-gray-800 hover:text-blue-500"
                >
                  ¬øPuedo compartir mis resultados?
                </summary>
                <p class="mt-2 text-gray-600 text-sm">
                  Proximamente podr√°s compartir tus logros con otros usuarios a
                  trav√©s del sistema de rankings.
                </p>
              </details>
            </div>

            <!-- Contacto -->
            <div class="border-t border-gray-200 pt-6">
              <h4 class="text-lg font-semibold text-gray-800 mb-4">
                ¬øNecesitas m√°s ayuda?
              </h4>
              <p class="text-gray-600 text-sm mb-4">
                Contacta con nuestro equipo de soporte para resolver cualquier
                duda.
              </p>
              <button
                class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
              >
                Enviar Mensaje
              </button>
            </div>
          </div>

          <!-- Configuraci√≥n -->
          <div id="configuracionContent" class="space-y-6 hidden">
            <div class="text-center">
              <div class="text-6xl mb-4">‚öôÔ∏è</div>
              <h3 class="text-xl font-bold text-gray-800">Configuraci√≥n</h3>
              <p class="text-gray-600 text-sm">Personaliza tu experiencia</p>
            </div>

            <!-- Tarjetas de Configuraci√≥n -->
            <div class="space-y-4">
              <!-- Mi Perfil -->
              <button
                onclick="mostrarSubContenido('volver-perfil')"
                class="w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:shadow-md transition-all"
              >
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-800">üë§ Mi Perfil</h4>
                  <span class="text-blue-500">‚Üí</span>
                </div>
                <p class="text-gray-600 text-sm">
                  Edita tu informaci√≥n personal
                </p>
              </button>

              <!-- Ayuda y Soporte -->
              <button
                onclick="mostrarSubContenido('ayuda-sub')"
                class="w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:shadow-md transition-all"
              >
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-800">
                    ‚ÑπÔ∏è Ayuda y Soporte
                  </h4>
                  <span class="text-green-500">‚Üí</span>
                </div>
                <p class="text-gray-600 text-sm">
                  Encuentra respuestas a tus preguntas
                </p>
              </button>

              <!-- Privacidad -->
              <button
                onclick="proximamente(event)"
                class="w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:shadow-md transition-all"
              >
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-800">
                    üîê Privacidad y Seguridad
                  </h4>
                  <span class="text-purple-500">‚Üí</span>
                </div>
                <p class="text-gray-600 text-sm">
                  Controla tu privacidad y seguridad
                </p>
              </button>
            </div>

            <!-- Secci√≥n Preferencias -->
            <div class="border-t border-gray-200 pt-6">
              <h4 class="text-lg font-semibold text-gray-800 mb-4">
                Preferencias
              </h4>
              <div class="space-y-3">
                <label class="flex items-center">
                  <input
                    type="checkbox"
                    checked
                    class="w-4 h-4 text-blue-500 rounded focus:ring-blue-500"
                  />
                  <span class="ml-3 text-gray-700">
                    Notificaciones activadas
                  </span>
                </label>
                <label class="flex items-center">
                  <input
                    type="checkbox"
                    checked
                    class="w-4 h-4 text-blue-500 rounded focus:ring-blue-500"
                  />
                  <span class="ml-3 text-gray-700"> Sonidos activados </span>
                </label>
              </div>
            </div>
          </div>

          <!-- Editar Perfil -->
          <div id="editarPerfilContent" class="space-y-6 hidden">
            <div class="text-center mb-6">
              <h3 class="text-xl font-bold text-gray-800">‚úèÔ∏è Editar Perfil</h3>
              <p class="text-gray-600 text-sm">
                Actualiza tu informaci√≥n personal
              </p>
            </div>

            <div class="space-y-4">
              <!-- Nombre -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  Nombre Completo
                </label>
                <input
                  type="text"
                  id="editNombre"
                  placeholder="Tu nombre"
                  class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
              </div>

              <!-- Fecha de Nacimiento -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  Fecha de Nacimiento
                </label>
                <input
                  type="date"
                  id="editFechaNacimiento"
                  class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <p id="edadAutomatica" class="text-xs text-gray-500 mt-1">
                  Se calcular√° autom√°ticamente
                </p>
              </div>

              <!-- Sexo -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  Sexo
                </label>
                <select
                  id="editSexo"
                  class="w-full px-4 py-2 border border-gray-300 bg-white text-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="">Selecciona una opci√≥n</option>
                  <option value="masculino">Masculino</option>
                  <option value="femenino">Femenino</option>
                  <option value="otro">Otro</option>
                  <option value="preferir_no_decir">Prefiero no decir</option>
                </select>
              </div>

              <!-- Foto de Perfil -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  üì∑ Foto de Perfil
                </label>
                <div class="flex items-center gap-4">
                  <img
                    id="previewFoto"
                    src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23e5e7eb'/%3E%3Ctext x='50' y='60' font-size='50' text-anchor='middle' fill='%239ca3af'%3Eüë§%3C/text%3E%3C/svg%3E"
                    class="w-16 h-16 rounded-full border-2 border-gray-300 object-cover"
                  />
                  <label class="flex-1 cursor-pointer">
                    <input
                      type="file"
                      id="editFoto"
                      accept="image/*"
                      class="hidden"
                    />
                    <span
                      class="inline-block bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
                    >
                      Cambiar Foto
                    </span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Botones de Acci√≥n -->
            <div class="border-t border-gray-200 pt-6 space-y-3">
              <button
                id="btnGuardarPerfil"
                class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
              >
                üíæ Guardar Cambios
              </button>
              <button
                onclick="volverMenu()"
                class="w-full bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg transition-colors"
              >
                Cancelar
              </button>
            </div>
          </div>

          <!-- Estad√≠sticas -->
          <div id="estadisticasContent" class="space-y-6 hidden">
            <div class="text-center">
              <div class="text-6xl mb-4">üìä</div>
              <h3 class="text-xl font-bold text-gray-800">Estad√≠sticas</h3>
              <p class="text-gray-600 text-sm">Tu progreso y desempe√±o</p>
            </div>

            <!-- Pesta√±as -->
            <div class="flex gap-2 border-b border-gray-200">
              <button
                onclick="cambiarPestanaEstadisticas('mi-progreso')"
                id="tabProgreso"
                class="px-4 py-2 border-b-2 border-blue-500 text-blue-600 font-semibold"
              >
                üìà Mi Progreso
              </button>
              <button
                onclick="cambiarPestanaEstadisticas('logros')"
                id="tabLogros"
                class="px-4 py-2 border-b-2 border-transparent text-gray-600 font-semibold hover:text-gray-800"
              >
                üèÜ Logros
              </button>
              <button
                onclick="cambiarPestanaEstadisticas('rankings')"
                id="tabRankings"
                class="px-4 py-2 border-b-2 border-transparent text-gray-600 font-semibold hover:text-gray-800"
              >
                üåü Rankings
              </button>
            </div>

            <!-- Contenido: Mi Progreso -->
            <div id="pestanaProgreso" class="space-y-4">
              <div class="grid grid-cols-2 gap-3">
                <div class="bg-blue-50 rounded-lg p-4 text-center">
                  <p
                    id="totalPartidas"
                    class="text-2xl font-bold text-blue-600"
                  >
                    0
                  </p>
                  <p class="text-xs text-gray-600 mt-1">Partidas Totales</p>
                </div>
                <div class="bg-green-50 rounded-lg p-4 text-center">
                  <p
                    id="puntosTotales"
                    class="text-2xl font-bold text-green-600"
                  >
                    0
                  </p>
                  <p class="text-xs text-gray-600 mt-1">Puntos Totales</p>
                </div>
                <div class="bg-purple-50 rounded-lg p-4 text-center">
                  <p
                    id="mejorPuntaje"
                    class="text-2xl font-bold text-purple-600"
                  >
                    0
                  </p>
                  <p class="text-xs text-gray-600 mt-1">Mejor Puntaje</p>
                </div>
                <div class="bg-orange-50 rounded-lg p-4 text-center">
                  <p
                    id="promedioPuntos"
                    class="text-2xl font-bold text-orange-600"
                  >
                    0
                  </p>
                  <p class="text-xs text-gray-600 mt-1">Promedio</p>
                </div>
              </div>

              <div class="border-t border-gray-200 pt-4">
                <h4 class="font-semibold text-gray-800 mb-3">üìã Por Juego</h4>
                <div id="detalleJuegos" class="space-y-2">
                  <p class="text-gray-500 text-sm text-center">Cargando...</p>
                </div>
              </div>
            </div>

            <!-- Contenido: Logros -->
            <div id="pestanaLogros" class="space-y-4 hidden">
              <div id="listaLogros" class="grid gap-3">
                <p class="text-gray-500 text-sm text-center">
                  Cargando logros...
                </p>
              </div>
            </div>

            <!-- Contenido: Rankings -->
            <div id="pestanaRankings" class="space-y-4 hidden">
              <div class="flex gap-2 mb-4 flex-wrap">
                <button
                  onclick="cambiarRanking('global')"
                  id="tabGlobal"
                  class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold"
                >
                  Global
                </button>
                <button
                  onclick="cambiarRanking('crucigrama')"
                  id="tabCrucigrama"
                  class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-semibold"
                >
                  Crucigrama
                </button>
                <button
                  onclick="cambiarRanking('ruleta')"
                  id="tabRuleta"
                  class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-semibold"
                >
                  Ruleta
                </button>
                <button
                  onclick="cambiarRanking('sopita')"
                  id="tabSopita"
                  class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-semibold"
                >
                  Sopita
                </button>
              </div>
              <div id="listaRanking" class="space-y-2">
                <p class="text-gray-500 text-sm text-center">
                  Cargando ranking...
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Overlay del Slide Panel -->
    <div
      id="slideOverlay"
      class="hidden fixed inset-0 bg-black/30 z-30 transition-opacity duration-300"
      onclick="cerrarSlide()"
    ></div>

    <script src="js/main.js"></script>
    <script>
      function proximamente(event) {
        event.preventDefault();
        document.getElementById("proximamenteModal").classList.remove("hidden");
      }

      function cerrarProximamente() {
        document.getElementById("proximamenteModal").classList.add("hidden");
      }

      function abrirPerfil() {
        mostrarSlide("perfil");
      }

      function abrirAyuda() {
        mostrarSlide("ayuda");
      }

      function abrirConfiguracion() {
        mostrarSlide("configuracion");
      }

      function abrirEstadisticas() {
        mostrarSlide("estadisticas");
      }

      function mostrarSlide(tipo) {
        const panel = document.getElementById("slidePanel");
        const overlay = document.getElementById("slideOverlay");
        const btnVolver = document.getElementById("btnVolver");
        const perfilContent = document.getElementById("perfilContent");
        const ayudaContent = document.getElementById("ayudaContent");
        const estadisticasContent = document.getElementById(
          "estadisticasContent"
        );
        const configuracionContent = document.getElementById(
          "configuracionContent"
        );

        if (tipo === "perfil") {
          perfilContent.classList.remove("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.add("hidden");
        } else if (tipo === "ayuda") {
          perfilContent.classList.add("hidden");
          ayudaContent.classList.remove("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.add("hidden");
        } else if (tipo === "estadisticas") {
          perfilContent.classList.add("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.remove("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.add("hidden");
        } else if (tipo === "configuracion") {
          perfilContent.classList.add("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.remove("hidden");
          btnVolver.classList.add("hidden");
        }

        // Mostrar panel y overlay
        panel.classList.remove("translate-x-full");
        overlay.classList.remove("hidden");
      }

      function mostrarSubContenido(tipo) {
        const btnVolver = document.getElementById("btnVolver");
        const perfilContent = document.getElementById("perfilContent");
        const editarPerfilContent = document.getElementById(
          "editarPerfilContent"
        );
        const ayudaContent = document.getElementById("ayudaContent");
        const estadisticasContent = document.getElementById(
          "estadisticasContent"
        );
        const configuracionContent = document.getElementById(
          "configuracionContent"
        );

        if (tipo === "volver-perfil") {
          perfilContent.classList.remove("hidden");
          editarPerfilContent.classList.add("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.remove("hidden");
        } else if (tipo === "editar-perfil") {
          perfilContent.classList.add("hidden");
          editarPerfilContent.classList.remove("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.remove("hidden");
        } else if (tipo === "ayuda-sub") {
          perfilContent.classList.add("hidden");
          editarPerfilContent.classList.add("hidden");
          ayudaContent.classList.remove("hidden");
          estadisticasContent.classList.add("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.remove("hidden");
        } else if (tipo === "estadisticas-sub") {
          perfilContent.classList.add("hidden");
          editarPerfilContent.classList.add("hidden");
          ayudaContent.classList.add("hidden");
          estadisticasContent.classList.remove("hidden");
          configuracionContent.classList.add("hidden");
          btnVolver.classList.remove("hidden");
        }
      }

      function volverMenu() {
        const btnVolver = document.getElementById("btnVolver");
        document.getElementById("perfilContent").classList.add("hidden");
        document.getElementById("editarPerfilContent").classList.add("hidden");
        document.getElementById("ayudaContent").classList.add("hidden");
        document.getElementById("estadisticasContent").classList.add("hidden");
        document
          .getElementById("configuracionContent")
          .classList.remove("hidden");
        btnVolver.classList.add("hidden");
      }

      function cerrarSlide() {
        const panel = document.getElementById("slidePanel");
        const overlay = document.getElementById("slideOverlay");

        panel.classList.add("translate-x-full");
        overlay.classList.add("hidden");
      }

      // Cerrar modal al hacer click fuera
      document
        .getElementById("proximamenteModal")
        .addEventListener("click", function (event) {
          if (event.target === this) {
            cerrarProximamente();
          }
        });

      // Cerrar slide al presionar ESC
      document.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          cerrarSlide();
        }
      });
    </script>

    <script src="js/supabase-config.js"></script>
    <script>
      // Funciones para manejar el blur del modal
      function mostrarBlur() {
        document.getElementById("mainContent").classList.add("blurred");
      }

      function ocultarBlur() {
        document.getElementById("mainContent").classList.remove("blurred");
      }

      // Cambiar entre tabs de login/registro
      function cambiarTab(tab) {
        const loginForm = document.getElementById("loginForm");
        const registroForm = document.getElementById("registroForm");
        const tabLogin = document.getElementById("tabLogin");
        const tabRegistro = document.getElementById("tabRegistro");

        if (tab === "login") {
          loginForm.classList.remove("hidden");
          registroForm.classList.add("hidden");
          tabLogin.classList.add("border-blue-500", "text-blue-600");
          tabLogin.classList.remove("border-transparent", "text-gray-600");
          tabRegistro.classList.remove("border-blue-500", "text-blue-600");
          tabRegistro.classList.add("border-transparent", "text-gray-600");
        } else {
          loginForm.classList.add("hidden");
          registroForm.classList.remove("hidden");
          tabRegistro.classList.add("border-blue-500", "text-blue-600");
          tabRegistro.classList.remove("border-transparent", "text-gray-600");
          tabLogin.classList.remove("border-blue-500", "text-blue-600");
          tabLogin.classList.add("border-transparent", "text-gray-600");
        }
      }

      // Manejar login
      document
        .getElementById("btnLogin")
        .addEventListener("click", async function () {
          const email = document.getElementById("loginEmail").value.trim();
          const password = document
            .getElementById("loginPassword")
            .value.trim();

          if (!email || !password) {
            alert("Por favor completa todos los campos");
            return;
          }

          const resultado = await iniciarSesion(email, password);
          if (resultado.success) {
            ocultarBlur();
            document.getElementById("loginModal").classList.add("hidden");
            actualizarUIConUsuario(resultado.usuario);
          } else {
            alert("‚ùå Error: " + resultado.error);
          }
        });

      // Manejar registro
      document
        .getElementById("btnRegistro")
        .addEventListener("click", async function () {
          const nombre = document.getElementById("registroNombre").value.trim();
          const email = document.getElementById("registroEmail").value.trim();
          const password = document
            .getElementById("registroPassword")
            .value.trim();
          const passwordConfirm = document
            .getElementById("registroPasswordConfirm")
            .value.trim();

          if (!nombre || !email || !password || !passwordConfirm) {
            alert("Por favor completa todos los campos");
            return;
          }

          if (password.length < 6) {
            alert("La contrase√±a debe tener al menos 6 caracteres");
            return;
          }

          if (password !== passwordConfirm) {
            alert("Las contrase√±as no coinciden");
            return;
          }

          const resultado = await registrarUsuario(email, password, nombre);
          if (resultado.success) {
            ocultarBlur();
            document.getElementById("loginModal").classList.add("hidden");
            actualizarUIConUsuario(resultado.usuario);
          } else {
            alert("‚ùå Error: " + resultado.error);
          }
        });

      // Event listener para preview de foto
      document
        .getElementById("editFoto")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file && file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = function (event) {
              document.getElementById("previewFoto").src = event.target.result;
            };
            reader.readAsDataURL(file);
          } else if (file) {
            alert("Por favor selecciona un archivo de imagen v√°lido");
          }
        });

      // Event listener para actualizar edad autom√°ticamente
      document
        .getElementById("editFechaNacimiento")
        .addEventListener("change", function (e) {
          const fecha = e.target.value;
          if (fecha) {
            const edad = calcularEdad(fecha);
            document.getElementById("edadAutomatica").textContent = edad;
          }
        });

      // Manejar guardar cambios de perfil
      document
        .getElementById("btnGuardarPerfil")
        .addEventListener("click", async function () {
          const usuario = obtenerUsuarioActual();
          if (!usuario) {
            alert("Debes iniciar sesi√≥n primero");
            return;
          }

          const nombre = document.getElementById("editNombre").value.trim();
          const fechaNacimiento = document.getElementById(
            "editFechaNacimiento"
          ).value;
          const sexo = document.getElementById("editSexo").value;
          const fotoPerfil = document.getElementById("previewFoto");

          if (!nombre || !fechaNacimiento) {
            alert("Por favor completa los campos requeridos");
            return;
          }

          // Obtener URL de la foto (podr√≠a ser data URL o URL existente)
          const fotoUrl = fotoPerfil.src || null;

          const datosActualizacion = {
            nombre,
            fecha_nacimiento: fechaNacimiento,
            sexo,
            foto_url: fotoUrl,
          };

          const actualizado = await actualizarPerfil(
            usuario.id,
            datosActualizacion
          );
          if (actualizado) {
            alert("‚úÖ Perfil actualizado correctamente");
            actualizarUIConUsuario(usuario);
            volverMenu();
          } else {
            alert("‚ùå Error al actualizar perfil");
          }
        });

      // Manejar cerrar sesi√≥n
      document
        .getElementById("btnCerrarSesion")
        .addEventListener("click", async function () {
          await cerrarSesion();
          location.reload();
        });

      // ===== FUNCIONES DE ESTAD√çSTICAS =====

      // Cambiar entre pesta√±as de estad√≠sticas
      function cambiarPestanaEstadisticas(pesta√±a) {
        // Ocultar todas las pesta√±as
        document.getElementById("pestanaProgreso").classList.add("hidden");
        document.getElementById("pestanaLogros").classList.add("hidden");
        document.getElementById("pestanaRankings").classList.add("hidden");

        // Quitar color de todos los botones
        document
          .getElementById("tabProgreso")
          .classList.remove("border-blue-500", "text-blue-600");
        document
          .getElementById("tabLogros")
          .classList.remove("border-blue-500", "text-blue-600");
        document
          .getElementById("tabRankings")
          .classList.remove("border-blue-500", "text-blue-600");

        document
          .getElementById("tabProgreso")
          .classList.add("border-transparent", "text-gray-600");
        document
          .getElementById("tabLogros")
          .classList.add("border-transparent", "text-gray-600");
        document
          .getElementById("tabRankings")
          .classList.add("border-transparent", "text-gray-600");

        // Mostrar pesta√±a seleccionada
        if (pesta√±a === "mi-progreso") {
          document.getElementById("pestanaProgreso").classList.remove("hidden");
          document
            .getElementById("tabProgreso")
            .classList.add("border-blue-500", "text-blue-600");
          document
            .getElementById("tabProgreso")
            .classList.remove("border-transparent", "text-gray-600");
          cargarProgreso();
        } else if (pesta√±a === "logros") {
          document.getElementById("pestanaLogros").classList.remove("hidden");
          document
            .getElementById("tabLogros")
            .classList.add("border-blue-500", "text-blue-600");
          document
            .getElementById("tabLogros")
            .classList.remove("border-transparent", "text-gray-600");
          cargarLogros();
        } else if (pesta√±a === "rankings") {
          document.getElementById("pestanaRankings").classList.remove("hidden");
          document
            .getElementById("tabRankings")
            .classList.add("border-blue-500", "text-blue-600");
          document
            .getElementById("tabRankings")
            .classList.remove("border-transparent", "text-gray-600");
          cargarRanking("global");
        }
      }

      // Cargar progreso del usuario
      async function cargarProgreso() {
        const usuario = obtenerUsuarioActual();
        if (!usuario) return;

        const resumen = await obtenerResumenEstadisticas(usuario.id);
        if (resumen) {
          document.getElementById("totalPartidas").textContent =
            resumen.total_partidas;
          document.getElementById("puntosTotales").textContent =
            resumen.puntos_totales;
          document.getElementById("mejorPuntaje").textContent =
            resumen.mejor_puntaje;
          document.getElementById("promedioPuntos").textContent =
            resumen.promedio_puntos;

          // Mostrar detalles por juego
          let html = "";
          Object.values(resumen.juegos).forEach((juego) => {
            html += `
              <div class="bg-gray-50 rounded-lg p-3">
                <div class="flex justify-between items-center">
                  <div>
                    <p class="font-semibold text-gray-800">${juego.nombre}</p>
                    <p class="text-xs text-gray-600">${juego.partidas} partidas</p>
                  </div>
                  <div class="text-right">
                    <p class="font-bold text-gray-800">${juego.puntos} pts</p>
                    <p class="text-xs text-gray-600">Mejor: ${juego.mejor}</p>
                  </div>
                </div>
              </div>
            `;
          });
          document.getElementById("detalleJuegos").innerHTML =
            html || "<p class='text-gray-500 text-sm'>Sin datos</p>";
        }
      }

      // Cargar logros del usuario
      async function cargarLogros() {
        const usuario = obtenerUsuarioActual();
        if (!usuario) return;

        const logros = await obtenerLogros(usuario.id);
        let html = "";

        Object.values(LOGROS_DISPONIBLES).forEach((logro) => {
          const obtenido = logros.some((l) => l.logro_id === logro.id);
          html += `
            <div class="bg-${
              obtenido ? "blue" : "gray"
            }-50 rounded-lg p-4 border-2 border-${
            obtenido ? "blue" : "gray"
          }-200">
              <div class="flex items-start gap-3">
                <span class="text-3xl">${logro.icono}</span>
                <div class="flex-1">
                  <h5 class="font-semibold text-gray-800">${logro.nombre}</h5>
                  <p class="text-sm text-gray-600">${logro.descripcion}</p>
                  ${
                    obtenido
                      ? '<p class="text-xs text-blue-600 font-semibold mt-1">‚úì Desbloqueado</p>'
                      : '<p class="text-xs text-gray-500 mt-1">Bloqueado</p>'
                  }
                </div>
              </div>
            </div>
          `;
        });

        document.getElementById("listaLogros").innerHTML = html;
      }

      // Cambiar ranking
      function cambiarRanking(tipo) {
        // Cambiar colores de botones
        document
          .getElementById("tabGlobal")
          .classList.remove("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabCrucigrama")
          .classList.remove("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabRuleta")
          .classList.remove("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabSopita")
          .classList.remove("bg-gray-200", "text-gray-800");

        document
          .getElementById("tabGlobal")
          .classList.add("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabCrucigrama")
          .classList.add("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabRuleta")
          .classList.add("bg-gray-200", "text-gray-800");
        document
          .getElementById("tabSopita")
          .classList.add("bg-gray-200", "text-gray-800");

        if (tipo === "global") {
          document
            .getElementById("tabGlobal")
            .classList.remove("bg-gray-200", "text-gray-800");
          document
            .getElementById("tabGlobal")
            .classList.add("bg-blue-500", "text-white");
        } else if (tipo === "crucigrama") {
          document
            .getElementById("tabCrucigrama")
            .classList.remove("bg-gray-200", "text-gray-800");
          document
            .getElementById("tabCrucigrama")
            .classList.add("bg-blue-500", "text-white");
        } else if (tipo === "ruleta") {
          document
            .getElementById("tabRuleta")
            .classList.remove("bg-gray-200", "text-gray-800");
          document
            .getElementById("tabRuleta")
            .classList.add("bg-blue-500", "text-white");
        } else if (tipo === "sopita") {
          document
            .getElementById("tabSopita")
            .classList.remove("bg-gray-200", "text-gray-800");
          document
            .getElementById("tabSopita")
            .classList.add("bg-blue-500", "text-white");
        }

        cargarRanking(tipo);
      }

      // Cargar ranking
      async function cargarRanking(tipo) {
        let ranking = [];

        if (tipo === "global") {
          ranking = await obtenerRankingGlobal(20);
        } else {
          ranking = await obtenerRankingJuego(tipo, 15);
        }

        let html = "";
        ranking.forEach((item, index) => {
          const medal =
            index === 0
              ? "ü•á"
              : index === 1
              ? "ü•à"
              : index === 2
              ? "ü•â"
              : `${index + 1}.`;
          const nombre = item.nombre || "Usuario";
          const puntos = item.puntos_totales || item.puntos;

          html += `
            <div class="flex items-center justify-between bg-gray-50 rounded-lg p-3">
              <div class="flex items-center gap-3">
                <span class="text-xl font-bold">${medal}</span>
                <div>
                  <p class="font-semibold text-gray-800">${nombre}</p>
                  ${
                    item.juegos_jugados
                      ? `<p class="text-xs text-gray-600">${item.juegos_jugados} juegos</p>`
                      : ""
                  }
                </div>
              </div>
              <p class="text-lg font-bold text-blue-600">${puntos}</p>
            </div>
          `;
        });

        document.getElementById("listaRanking").innerHTML =
          html ||
          "<p class='text-gray-500 text-sm text-center'>No hay datos</p>";
      }

      // Verificar si el usuario est√° logueado al cargar
      document.addEventListener("DOMContentLoaded", function () {
        const usuarioGuardado = obtenerUsuarioActual();
        if (usuarioGuardado) {
          ocultarBlur();
          document.getElementById("loginModal").classList.add("hidden");
          actualizarUIConUsuario(usuarioGuardado);
        } else {
          mostrarBlur();
        }
      });
    </script>
  </body>
</html>
